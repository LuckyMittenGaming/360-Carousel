<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>360° Vehicle Carousel</title>
  <link rel="stylesheet" href="carousel-final.css" />
</head>
<body>
  <div class="carousel-wrapper">
    <div class="carousel-container">
      <div class="carousel" id="carousel">
        <!-- 10 Cards -->
        <!-- Cards 34–52 -->
        <!-- Replace placeholder images with your own -->
        <!-- CARD START -->
        <!-- CARD 34 to 52 with Lightbox Thumbs -->
        <!-- Use loop or repeat in your dev env for efficiency -->
        <!-- BEGIN CARD LOOP -->
        <!-- Manually rendered below for clarity -->
        <!-- EACH CARD BLOCK -->
        
        <!-- CARD 34 -->
        <div class="carousel-card">
          <img src="van-main.jpg" />
          <h3>34 Passenger Party Bus</h3>
          <p>Perfect for groups, club transport</p>
          <a href="https://lasvegaspartybus.com/contact-us" class="cta">BEST OFFER!</a>

         <div class="interior-lightbox-thumbs">
            <img src="van1.jpg" data-full="van1-large.jpg" />
            <img src="van2.jpg" data-full="van2-large.jpg" />
            <img src="van3.jpg" data-full="van3-large.jpg" />
            <img src="van4.jpg" data-full="van4-large.jpg" />
          </div>
          <a class="vehicle-info" href="#">Vehicle Info</a>
          <div class="glow-offer">Free Glow Shirt for All Your Riders!</div>
        </div>

        <!-- Repeat above for 36–52 -->
        <!-- CARD 36 -->
        <div class="carousel-card">
          <img src="van-main.jpg" />
          <h3>36 Passenger Party Bus</h3>
          <p>Perfect for groups, club transport</p>
          <button class="cta">BEST OFFER!</button>
          <div class="interior-lightbox-thumbs">
            <img src="van1.jpg" data-full="van1-large.jpg" />
            <img src="van2.jpg" data-full="van2-large.jpg" />
            <img src="van3.jpg" data-full="van3-large.jpg" />
            <img src="van4.jpg" data-full="van4-large.jpg" />
          </div>
          <a class="vehicle-info" href="#">Vehicle Info</a>
          <div class="glow-offer">Free Glow Shirt for All Your Riders!</div>
        </div>

        <!-- CARD 38 -->
        <div class="carousel-card">
          <img src="van-main.jpg" />
          <h3>38 Passenger Party Bus</h3>
          <p>Perfect for groups, club transport</p>
          <button class="cta">BEST OFFER!</button>
          <div class="interior-lightbox-thumbs">
            <img src="van1.jpg" data-full="van1-large.jpg" />
            <img src="van2.jpg" data-full="van2-large.jpg" />
            <img src="van3.jpg" data-full="van3-large.jpg" />
            <img src="van4.jpg" data-full="van4-large.jpg" />
          </div>
          <a class="vehicle-info" href="#">Vehicle Info</a>
          <div class="glow-offer">Free Glow Shirt for All Your Riders!</div>
        </div>

        <!-- CARD 40 -->
        <div class="carousel-card">
          <img src="van-main.jpg" />
          <h3>40 Passenger Party Bus</h3>
          <p>Perfect for groups, club transport</p>
          <button class="cta">BEST OFFER!</button>
          <div class="interior-lightbox-thumbs">
            <img src="van1.jpg" data-full="van1-large.jpg" />
            <img src="van2.jpg" data-full="van2-large.jpg" />
            <img src="van3.jpg" data-full="van3-large.jpg" />
            <img src="van4.jpg" data-full="van4-large.jpg" />
          </div>
          <a class="vehicle-info" href="#">Vehicle Info</a>
          <div class="glow-offer">Free Glow Shirt for All Your Riders!</div>
        </div>

        <!-- CARD 42 -->
        <div class="carousel-card">
          <img src="van-main.jpg" />
          <h3>42 Passenger Party Bus</h3>
          <p>Perfect for groups, club transport</p>
          <button class="cta">BEST OFFER!</button>
          <div class="interior-lightbox-thumbs">
            <img src="van1.jpg" data-full="van1-large.jpg" />
            <img src="van2.jpg" data-full="van2-large.jpg" />
            <img src="van3.jpg" data-full="van3-large.jpg" />
            <img src="van4.jpg" data-full="van4-large.jpg" />
          </div>
          <a class="vehicle-info" href="#">Vehicle Info</a>
          <div class="glow-offer">Free Glow Shirt for All Your Riders!</div>
        </div>

        <!-- CARD 44 -->
        <div class="carousel-card">
          <img src="van-main.jpg" />
          <h3>44 Passenger Party Bus</h3>
          <p>Perfect for groups, club transport</p>
          <button class="cta">BEST OFFER!</button>
          <div class="interior-lightbox-thumbs">
            <img src="van1.jpg" data-full="van1-large.jpg" />
            <img src="van2.jpg" data-full="van2-large.jpg" />
            <img src="van3.jpg" data-full="van3-large.jpg" />
            <img src="van4.jpg" data-full="van4-large.jpg" />
          </div>
          <a class="vehicle-info" href="#">Vehicle Info</a>
          <div class="glow-offer">Free Glow Shirt for All Your Riders!</div>
        </div>

        <!-- CARD 46 -->
        <div class="carousel-card">
          <img src="van-main.jpg" />
          <h3>46 Passenger Party Bus</h3>
          <p>Perfect for groups, club transport</p>
          <button class="cta">BEST OFFER!</button>
          <div class="interior-lightbox-thumbs">
            <img src="van1.jpg" data-full="van1-large.jpg" />
            <img src="van2.jpg" data-full="van2-large.jpg" />
            <img src="van3.jpg" data-full="van3-large.jpg" />
            <img src="van4.jpg" data-full="van4-large.jpg" />
          </div>
          <a class="vehicle-info" href="#">Vehicle Info</a>
          <div class="glow-offer">Free Glow Shirt for All Your Riders!</div>
        </div>

        <!-- CARD 48 -->
        <div class="carousel-card">
          <img src="van-main.jpg" />
          <h3>48 Passenger Party Bus</h3>
          <p>Perfect for groups, club transport</p>
          <button class="cta">BEST OFFER!</button>
          <div class="interior-lightbox-thumbs">
            <img src="van1.jpg" data-full="van1-large.jpg" />
            <img src="van2.jpg" data-full="van2-large.jpg" />
            <img src="van3.jpg" data-full="van3-large.jpg" />
            <img src="van4.jpg" data-full="van4-large.jpg" />
          </div>
          <a class="vehicle-info" href="#">Vehicle Info</a>
          <div class="glow-offer">Free Glow Shirt for All Your Riders!</div>
        </div>

        <!-- CARD 50 -->
        <div class="carousel-card">
          <img src="van-main.jpg" />
          <h3>50 Passenger Party Bus</h3>
          <p>Perfect for groups, club transport</p>
          <button class="cta">BEST OFFER!</button>
          <div class="interior-lightbox-thumbs">
            <img src="van1.jpg" data-full="van1-large.jpg" />
            <img src="van2.jpg" data-full="van2-large.jpg" />
            <img src="van3.jpg" data-full="van3-large.jpg" />
            <img src="van4.jpg" data-full="van4-large.jpg" />
          </div>
          <a class="vehicle-info" href="#">Vehicle Info</a>
          <div class="glow-offer">Free Glow Shirt for All Your Riders!</div>
        </div>

        <!-- CARD 52 -->
        <div class="carousel-card">
          <img src="van-main.jpg" />
          <h3>52 Passenger Party Bus</h3>
          <p>Perfect for groups, club transport</p>
          <button class="cta">BEST OFFER!</button>
          <div class="interior-lightbox-thumbs">
            <img src="van1.jpg" data-full="van1-large.jpg" />
            <img src="van2.jpg" data-full="van2-large.jpg" />
            <img src="van3.jpg" data-full="van3-large.jpg" />
            <img src="van4.jpg" data-full="van4-large.jpg" />
          </div>
          <a class="vehicle-info" href="#">Vehicle Info</a>
          <div class="glow-offer">Free Glow Shirt for All Your Riders!</div>
        </div>

      </div>
    </div>
    <div class="arrow-container">
      <div id="arrow-left" class="arrow">&larr;</div>
      <div id="arrow-right" class="arrow">&rarr;</div>
    </div>
  </div>

  <!-- Lightbox Overlay -->
  <div id="lightbox-overlay" class="lightbox-overlay">
    <span id="lightbox-close">&times;</span>
    <img id="lightbox-img" src="" alt="Full View" />
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Draggable.min.js"></script>
  <script src="carousel-final.js"></script>

  <!-- Lightbox Script -->
  <script>
    document.querySelectorAll('.interior-lightbox-thumbs img').forEach(img => {
      img.addEventListener('click', () => {
        const fullSrc = img.getAttribute('data-full');
        document.getElementById('lightbox-img').src = fullSrc;
        document.getElementById('lightbox-overlay').style.display = 'flex';
      });
    });

    document.getElementById('lightbox-close').addEventListener('click', () => {
      document.getElementById('lightbox-overlay').style.display = 'none';
    });
  </script>
<script>

const carousel = document.getElementById("carousel");
const cards = document.querySelectorAll(".carousel-card");
const totalCards = cards.length;
const radius = 600;
let currentProgress = 0;
let spinActive = false;
let autoSpin;
let dragStartProgress = 0;
let lastX = 0;
const dragDistancePerRotation = 800;
const dragThreshold = 10;
const proxy = document.createElement("div");
document.body.appendChild(proxy);

function clamp(value, min, max) {
  return Math.min(Math.max(value, min), max);
}

function setCardTransforms(progress) {
  currentProgress = progress;
  const baseAngle = progress * 360;

  cards.forEach((card, i) => {
    const cardAngle = i * (360 / totalCards);
    let rotation = cardAngle - baseAngle;

    while (rotation > 180) rotation -= 360;
    while (rotation < -180) rotation += 360;

    const clampedRotation = clamp(rotation, -90, 90);
    const distanceFromCenter = Math.abs(clampedRotation / 90); // 0 = center, 1 = edge

    // ✨ Visual Enhancements
    const scale = 1 + (1 - distanceFromCenter) * 0.3; // Smooth scale in
    const opacity = 1.1 - distanceFromCenter;           // Smooth fade in/out
    const zIndex = distanceFromCenter < 0.2 ? 8 : 1;

    const blur = Math.min(20, distanceFromCenter * -4); // Optional blur
    card.style.filter = `blur(${blur}px)`;              // Set blur

    gsap.set(card, {
      rotationY: clampedRotation,
      scale: scale,
      zIndex: zIndex,
      opacity: opacity,
      transformOrigin: `50% 50% -${radius}px`
    });
  });
}

function startAutoSpin() {
  if (spinActive) return;
  spinActive = true;
  autoSpin = gsap.to({}, {
    duration: 100,
    repeat: -1,
    onUpdate: () => {
      currentProgress += 0.0005;
      setCardTransforms(currentProgress);
    }
  });
}

function stopAutoSpin() {
  if (autoSpin) autoSpin.kill();
  spinActive = false;
}

function snapToCard(index) {
  const targetProgress = index / totalCards;
  gsap.to({}, {
    duration: 0.6,
    onUpdate: function () {
      const progress = gsap.getProperty(this, "progress") * (targetProgress - currentProgress) + currentProgress;
      setCardTransforms(progress);
    },
    onComplete: () => {
      currentProgress = targetProgress;
    }
  });
}

setCardTransforms(0);
//startAutoSpin();//

Draggable.create(proxy, {
  trigger: ".carousel-container",
  type: "x",
  onPress() {
    stopAutoSpin();
    lastX = this.x;
    dragStartProgress = currentProgress;
  },
  onDrag() {
    const dragOffset = this.startX - this.x;
    const progressDelta = dragOffset / dragDistancePerRotation;
    const newProgress = dragStartProgress + progressDelta;
    setCardTransforms(newProgress);
  },
  onRelease() {
    const moved = Math.abs(this.x - lastX);
    if (moved > dragThreshold) {
      let closestIndex = 0;
      let smallestDiff = Infinity;
      cards.forEach((card, i) => {
        const angle = gsap.getProperty(card, "rotationY");
        const diff = Math.abs(angle);
        if (diff < smallestDiff) {
          smallestDiff = diff;
          closestIndex = i;
        }
      });
      snapToCard(closestIndex);
    }
    //startAutoSpin();
  }
});

cards.forEach((card, index) => {
  card.addEventListener("click", () => {
    stopAutoSpin();
    snapToCard(index);
  });
});

document.getElementById("arrow-left").addEventListener("click", () => {
  stopAutoSpin();
  const index = Math.round(currentProgress * totalCards) + 1;
  snapToCard((index + totalCards) % totalCards);
  //setTimeout(startAutoSpin, 10000);
});
document.getElementById("arrow-right").addEventListener("click", () => {
  stopAutoSpin();
  const index = Math.round(currentProgress * totalCards) - 1;
  snapToCard((index + totalCards) % totalCards);
  //setTimeout(startAutoSpin, 10000);
});

</script>
</body>
</html>
